(()=>{"use strict";class t{constructor(){this.boardSize=10,this.coordinates=new Map,this.AttackStorage=[],this.missedAttacks=[],this.playerboard=this.createBoard()}createBoard(){const t=[];for(let e=0;e<this.boardSize;e++){const e=[];for(let t=0;t<this.boardSize;t++)e.push(0);t.push(e)}return t}placeShip(t){for(const e of t){let r=0;const o=t.indexOf(e);console.log();let n=[];for(let t=0;t<e.length;t++)console.log([r+t,o]),n.push([r+t,o]);r++,this.AddShipCoords(e,n)}}AddShipCoords(t,e){this.coordinates.set(t,e)}receiveAttack(t,e){for(let e=0;e<this.AttackStorage.length;e++)if(JSON.stringify(t)==JSON.stringify(this.AttackStorage[e]))return!1;const r=document.querySelector(".container").querySelector(`.${e}`);let o=!1;this.coordinates.forEach(((e,n)=>{e.forEach(((a,s)=>{a[0]===t[0]&&a[1]===t[1]&&(n.hit(),e.splice(s,1),this.checkSunk(),o=!0,r.querySelectorAll(".cell").forEach((e=>{const r=JSON.parse(e.getAttribute("data-coordinate"));r[0]===t[0]&&r[1]===t[1]&&(e.style.backgroundColor="red")})))}))})),o||(this.missedAttacks.push(t),r.querySelectorAll(".cell").forEach((e=>{const r=JSON.parse(e.getAttribute("data-coordinate"));r[0]===t[0]&&r[1]===t[1]&&(e.style.backgroundColor="blue")}))),this.AttackStorage.push(t)}checkSunk(){let t=!0;return this.coordinates.forEach((e=>{e.length>0&&(t=!1)})),t}}class e{constructor(t,e=0,r=!1){this.length=t,this.numOfHits=e,this.sunk=r}hit(){this.numOfHits!==this.length&&this.numOfHits++,this.numOfHits===this.length&&this.isSunk()}isSunk(){this.sunk=!0}}class r{constructor(r){this.word=r,this.gameBoard=new t(r),this.PlayerShips=[new e(5),new e(4),new e(3),new e(3),new e(2)]}attack(t){this.gameBoard.receiveAttack(t,this.word)}makeRandomAttack(t){const e=this.gameBoard.boardSize;let r,o=!0;for(;o;){r=[Math.floor(Math.random()*e),Math.floor(Math.random()*e)],o=!1;for(let t=0;t<this.gameBoard.AttackStorage.length;t++)if(JSON.stringify(r)===JSON.stringify(this.gameBoard.AttackStorage[t])){o=!0;break}}this.gameBoard.receiveAttack(r,t)}gameOver(){return this.gameBoard.checkSunk()}}const o=new r("one"),n=new r("two");function a(t){let e=document.querySelector(".container"),r=document.createElement("div");r.classList.add("grid",t),e.append(r);for(let t=0;t<10;t++){const e=[];for(let o=0;o<10;o++){const n=document.createElement("div");n.classList.add("cell"),n.setAttribute("data-coordinate",`[${t},${o}]`),r.appendChild(n),e.push(0)}}}o.gameBoard.placeShip(o.PlayerShips),n.gameBoard.placeShip(n.PlayerShips),a("one"),a("two");const s=document.querySelector(".two").querySelectorAll(".cell"),c=document.querySelector(".playerNum");function i(t){const e=t.target,r=e.getAttribute("data-coordinate");n.attack(JSON.parse(r),"two"),o.makeRandomAttack("one"),e.removeEventListener("click",i),function(){const t=n.gameOver();o.gameOver()?(c.textContent="Player 2 wins",s.forEach((t=>{t.removeEventListener("click",i)}))):t&&(c.textContent="Player 1 wins",s.forEach((t=>{t.removeEventListener("click",i)})))}()}s.forEach((t=>{t.addEventListener("click",i)}));let l=null;const d=document.querySelectorAll(".ship"),h=(document.querySelectorAll(".cell"),document.querySelector(".one"));function u(t){l=t.target}function g(t){l=null}d.forEach((t=>{t.addEventListener("dragstart",u),t.addEventListener("dragend",g)})),h.addEventListener("drop",(function(t){t.preventDefault();const e=t.target;e.classList.contains("cell")&&e.appendChild(l)})),h.addEventListener("dragover",(function(t){t.preventDefault()}))})();